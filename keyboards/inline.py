from aiogram.types import InlineKeyboardMarkup, InlineKeyboardButton
import data_store

def create_admin_panel():
    keyboard = InlineKeyboardMarkup(row_width=2)
    cfg = data_store.bot_data['bot_settings']
    
    buttons = [
        ("ğŸ“ Ø§Ù„Ø±Ø¯ÙˆØ¯ Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ©", "admin_dyn_replies"), 
        ("ğŸ’­ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ°ÙƒÙŠØ±Ø§Øª", "admin_reminders"),
        ("ğŸ“¢ Ø¥Ø¯Ø§Ø±Ø© Ù…Ù†Ø´ÙˆØ±Ø§Øª Ø§Ù„Ù‚Ù†Ø§Ø©", "admin_channel"), 
        ("âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù‚Ù†Ø§Ø©", "admin_channel_settings"),
        ("ğŸš« Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø¸Ø±", "admin_ban"),
        ("ğŸ“¤ Ø§Ù„Ù†Ø´Ø± Ù„Ù„Ø¬Ù…ÙŠØ¹", "admin_broadcast"), 
        ("ğŸ¨ ØªØ®ØµÙŠØµ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø¨ÙˆØª", "admin_customize_ui"), 
        ("ğŸ›¡ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø­Ù…Ø§ÙŠØ© ÙˆØ§Ù„Ø£Ù…Ø§Ù†", "admin_security"),
        ("ğŸ§  Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø°Ø§ÙƒØ±Ø©", "admin_memory_management"),
        ("ğŸš€ Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø´Ø±", "deploy_status"), 
        ("âŒ Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù„ÙˆØ­Ø©", "close_panel")
    ]
    keyboard.add(*[InlineKeyboardButton(text=text, callback_data=cb) for text, cb in buttons])
    return keyboard

def create_user_buttons():
    ui_conf = data_store.bot_data['ui_config']
    keyboard = InlineKeyboardMarkup(row_width=1)
    buttons = [
        (ui_conf.get('date_button_label'), "hijri_today"),
        (ui_conf.get('time_button_label'), "live_time"),
        (ui_conf.get('reminder_button_label'), "daily_reminder")
    ]
    keyboard.add(*[InlineKeyboardButton(text=text, callback_data=cb) for text, cb in buttons])
    return keyboard

def get_menu_keyboard(menu_type):
    keyboard = InlineKeyboardMarkup(row_width=2)
    cfg = data_store.bot_data['bot_settings']

    buttons_map = {
        "admin_dyn_replies": [("â• Ø¨Ø±Ù…Ø¬Ø© Ø±Ø¯ Ø¬Ø¯ÙŠØ¯", "add_dyn_reply"), ("ğŸ—‘ï¸ Ø­Ø°Ù Ø±Ø¯ Ù…Ø¨Ø±Ù…Ø¬", "delete_dyn_reply"), ("ğŸ“ Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø¯ÙˆØ¯", "show_dyn_replies")],
        "admin_reminders": [("â• Ø¥Ø¶Ø§ÙØ© ØªØ°ÙƒÙŠØ±", "add_reminder"), ("ğŸ—‘ï¸ Ø­Ø°Ù ØªØ°ÙƒÙŠØ±", "delete_reminder"), ("ğŸ“ Ø¹Ø±Ø¶ Ø§Ù„ØªØ°ÙƒÙŠØ±Ø§Øª", "show_reminders")],
        "admin_channel": [("â• Ø¥Ø¶Ø§ÙØ© Ø±Ø³Ø§Ù„Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ©", "add_channel_msg"), ("ğŸ—‘ï¸ Ø­Ø°Ù Ø±Ø³Ø§Ù„Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ©", "delete_channel_msg"), ("ğŸ“ Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„", "show_channel_msgs"), ("ğŸ“¤ Ù†Ø´Ø± ÙÙˆØ±ÙŠ", "instant_channel_post"), ("â° Ø¬Ø¯ÙˆÙ„Ø© Ø±Ø³Ø§Ù„Ø© Ù…Ø­Ø¯Ø¯Ø©", "schedule_post")],
        "admin_channel_settings": [("ğŸ†” ØªØ¹Ø¯ÙŠÙ„ ID Ø§Ù„Ù‚Ù†Ø§Ø©", "set_channel_id"), ("â° ØªØ¹Ø¯ÙŠÙ„ ÙØªØ±Ø© Ø§Ù„Ù†Ø´Ø± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ", "set_schedule_interval")],
        "admin_ban": [("ğŸš« Ø­Ø¸Ø± Ù…Ø³ØªØ®Ø¯Ù…", "ban_user"), ("âœ… Ø¥Ù„ØºØ§Ø¡ Ø­Ø¸Ø±", "unban_user"), ("ğŸ“‹ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø­Ø¸ÙˆØ±ÙŠÙ†", "show_banned")],
        "admin_customize_ui": [("âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø²Ø± Ø§Ù„ØªØ§Ø±ÙŠØ®", "edit_date_button"), ("âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø²Ø± Ø§Ù„Ø³Ø§Ø¹Ø©", "edit_time_button"), ("âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø²Ø± Ø§Ù„ØªØ°ÙƒÙŠØ±", "edit_reminder_button"), ("ğŸ‘‹ ØªØ¹Ø¯ÙŠÙ„ Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨", "edit_welcome_msg"), ("ğŸ’¬ ØªØ¹Ø¯ÙŠÙ„ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø±Ø¯", "edit_reply_msg")],
        "admin_security": [
            ("ğŸ”´ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¨ÙˆØª" if not cfg['maintenance_mode'] else "ğŸŸ¢ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨ÙˆØª", "toggle_maintenance"),
            ("ğŸ”’ ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø­Ù…Ø§ÙŠØ©" if not cfg['content_protection'] else "ğŸ”“ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø­Ù…Ø§ÙŠØ©", "toggle_protection"),
            ("ğŸ”§ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ±Ø§Ø±", "spam_settings"),
            ("â³ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ¨Ø§Ø·Ø¤", "slow_mode_settings"),
            ("ğŸ–¼ï¸ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙˆØ³Ø§Ø¦Ø·", "media_settings"),
        ],
        "media_settings": [("â• Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ù†ÙˆØ¹ ÙˆØ³Ø§Ø¦Ø·", "add_media_type"), ("â– Ù…Ù†Ø¹ Ù†ÙˆØ¹ ÙˆØ³Ø§Ø¦Ø·", "remove_media_type")],
        "admin_memory_management": [("ğŸ—‘ï¸ Ù…Ø³Ø­ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø³ØªØ®Ø¯Ù…", "clear_user_data"), ("ğŸ§¹ Ù…Ø³Ø­ Ø°Ø§ÙƒØ±Ø© Spam", "clear_spam_cache")]
    }
    
    buttons = [InlineKeyboardButton(text=text, callback_data=cb) for text, cb in buttons_map.get(menu_type, [])]
    if buttons: keyboard.add(*buttons)
    
    # Back button logic
    if menu_type in ["media_settings"]:
        keyboard.add(InlineKeyboardButton(text="ğŸ”™ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø­Ù…Ø§ÙŠØ©", callback_data="admin_security"))
    else:
        keyboard.add(InlineKeyboardButton(text="ğŸ”™ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…", callback_data="back_to_main"))

    return keyboard

def back_kb(callback_data: str = "back_to_main"):
    return InlineKeyboardMarkup().add(InlineKeyboardButton(text="ğŸ”™ Ø§Ù„Ø¹ÙˆØ¯Ø©", callback_data=callback_data))
